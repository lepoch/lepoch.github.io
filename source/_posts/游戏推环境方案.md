---
title: 游戏推环境方案
date: 2017-05-27T09:57:00.000Z
tags:

categories:

---

游戏推环境方案


<!-- MORE -->

# 所需
## 开发测试环境
- Git、SVN
- Nginx、MySQL、PHP、Redis
- 代码推送
- VPN

后续：
- 代码质量检测服务 - SonarQube
- 生产环境接口稳定检测 - Nagios


## 生产环境
- Nginx、MySQL、PHP、Redis、Python
- 负载均衡、MySQL高可用
- 计划任务服务、Redis-PHP队列服务
- 静态资源服务
- APP推送服务
- 短信服务
- ***推荐服务***

后续：
- CMS
- 日志服务

# 方案
## 开发测试环境
### 阿里云服务器
#### 成本：
- Haswell 2.5G，1Mb宽带，8G内存，1T硬盘每年大概需要7102.26
- 自行搭建Git等服务

#### 优点：
- 运维成本低
- 稳定、备份简单

#### 劣势：
- 速度比局域网服务器略慢

### 自买局域网服务器
#### 成本：
- 至强 3.3G， 局域网， 8G内存，1T硬盘，每台需要4999，需两台

#### 优点：
- 价格低
- 局域网速度快

#### 劣势：
- 运维成本高
- 备份复杂、不可靠
-




## 生产环境




# 采用
## 开发测试环境  
### 阿里云服务器

- 开发服务器  
包括Nginx、PHP、MySQL、Rsync、Redis等稳定开发环境
>计费方式：包年包月  
地域：华北 3（华北 3 可用区 A）实例  
规格：2核 4GB（通用型 n4）  
I/O 优化：I/O 优化实例  
网络：带宽 2Mbps（专有网络）  
安全组：  
镜像：CentOS 7.3 64位  
系统盘：高效云盘（500 GB）  
购买量：1 年1 台  
配置费用：**¥2619.87**   省¥711.33  

- 代码仓库服务器  
包括GitLib
>计费方式：包年包月  
地域：华北3(华北 3 可用区 A)    
镜像：镜像Gitlab代码托管平台系统（CentOS7.0 64位）    
规格：云服务器2 核 4GB  
网络：1M带宽（专有网络)    
购买量：1 年1 台    
配置费用：**¥2813.57**     

开发测试环境总需： ¥2619.87 + ¥2813.57 = **¥5433.44 / 年**


# 云服务器比较
## 腾讯云
- 价格便宜一点
> 计费模式	包年包月  
地域	华北地区（北京）  
可用区	北京二区  
机型	系列2、标准型S2、2核CPU、4G内存  
镜像	CentOS 7.2 64位存储	系统盘（20G 本地硬盘）、 数据盘（100G 本地硬盘）  
所属网络	基础网络  
带宽	按带宽计费(带宽1Mbps)  
购买量	1台 × 1年  
费用 2509.92
- 支持智能推荐
- 可同时在阿里云与腾讯云上备案。备案转入，初审1工作日（通过，则网站能用），复审1工作日，管局22工作日



## 生产环境
### web服务器  27041.4    
5408.28／1台／1年  （web两台 + 后台管理1台 + es两台）

计费模式	包年包月
地域	华北地区（北京）
可用区	北京二区
机型	系列2、标准型S2、4核CPU、8G内存
镜像	CentOS 7.2 64位
存储	系统盘（50G 云硬盘）、 数据盘（100G SSD云硬盘）
所属网络	基础网络
带宽	按量，每天5g， 365 * 0.8 = 292
购买量	1台 × 1年    4621.44 + 292 * 2 = 5300

### mysql   1374.48
实例类型 : 主实例
计费模式 : 包年包月
配置类型 : 高IO版
配置 : 1000MB内存，50GB存储空间，1000次/秒，MySQL5.6
地域 : 华北地区（北京）
可用区 : 北京二区
所属网络 : 猫爪—web
项目 : 默认项目
数据复制方式 : 半同步复制

### redis   3784.80
地域 : 北京二区
网络类型 : 猫爪 web
规格 : 主从版
内存大小 : 5GB
所属项目 : 默认项目

### 负载均衡 CLB    0


1、web服务器 2台， 11000 / 年  4621.44 + 0.8 * 365 * 2
2、后台服务器1台，  5000 / 年
3、es服务器2台，10000 / 年
4、mysql 1对主从， 1374.48 / 年
5、redis 1对主从， 3784.80 / 年
6、对象存储，后付费模式，按照200G来算，需600 / 年
7、负载均衡内网模式， 365 / 年
8、短信服务，后付费模式， 按0.045 / 条价格，每月5000 条计算，需 2700 / 年

9、大数据服务 20000 / 年

总需  35000 / 年
