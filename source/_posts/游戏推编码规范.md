---
title: 游戏推编码规范
date: 2017-05-18T23:06:00.000Z
tags:
    - PHP
    - laravel
    - 规范
    - 游戏推

---

游戏推编码规范

<!-- MORE -->
# PSR-[0-4] 规范  
具体见[PSR](https://www.zybuluo.com/phper/note/65033)  
这里我只简单强调几点。

一般的IDE都有一键PSR格式化，  
然而其只能做到花括号位置调整、空格调整等功能，  
剩下的就得靠**自己**注意了。

## PHP文件规范
1. 只使用 <?php标签
- 只使用不带BOM的UTF-8文件（IDE代办）
- 纯PHP代码源文件的关闭标签?>必须省略。
- 必须使用Unix LF(换行)作为行结束符。（IDE代办）

## 命名规范
1. 命名空间必须跟目录、文件名保持关联，如文件 Doctrine/Common/IsolatedClassLoader.php 的类应是

```
namespace  Doctrine\Common\

class IsolatedClassLoader
{
    // ...
}
```
- 类名(class name) 必须使用骆驼式(StudlyCaps)写法
- 类名必须要和对应的文件名要一模一样，大小写也要一模一样
- 类(class)中的常量必须只由大写字母和下划线(_)组成
- 方法名(method name) 必须使用驼峰式(cameCase)写法
- 属性(property)、方法(method)必须声明其可见性

## 代码风格
1. 文件末尾必须空一行。
- 必须使用4个空格来缩进
- 一行推荐的是最多写80个字符
- php的关键字，必须小写，boolean值：true，false，null 也必须小写
> '__halt_compiler', 'abstract', 'and', 'array', 'as', 'break', 'callable', 'case', 'catch', 'class', 'clone', 'const', 'continue', 'declare', 'default', 'die', 'do', 'echo', 'else', 'elseif', 'empty', 'enddeclare', 'endfor', 'endforeach', 'endif', 'endswitch', 'endwhile', 'eval', 'exit', 'extends', 'final', 'for', 'foreach', 'function', 'global', 'goto', 'if', 'implements', 'include', 'include_once', 'instanceof', 'insteadof', 'interface', 'isset', 'list', 'namespace', 'new', 'or', 'print', 'private', 'protected', 'public', 'require', 'require_once', 'return', 'static', 'switch', 'throw', 'trait', 'try', 'unset', 'use', 'var', 'while', 'xor'

- 类、方法、函数的花括号换行

```
<?php
namespace Lib\Databaes;

class Mysql extends ParentClass implements \PDO, \DB  // 写一行
{ //换行写{
}
```

- if else while switch等花括号不换行
```
<?php
if ($expr1) { //左右空格
    // if body
} elseif ($expr2) { //elesif 连着写
    // elseif body
} else {
    // else body;
}
```

# 注释规范
- 这得重点强调，每个类、方法都需有注释，且需要注明时间、作者
- 修改时，注明修改人、修改时间

# laravel 规范
## [helper方法](http://www.golaravel.com/laravel/docs/5.4/helpers/)
在有helper方法的前提下，**强烈建议**使用helper方法代替对应的Facade或其他操作。

## 目录结构的调整
- 追加App/Models目录，App/User.php迁移至App/Models目录中，注意修改NameSpace和Use。
- 追加App/Libs目录，用于存放业务逻辑代码，参考了laravel官方示例的App/Repositories目录。

## 类调用写法
- 除使用Laravel的Facade等机制外，其他常规代码**必须**在php文件前部先use所需要使用的类，然后代码中直接调用。
- 如果出现不同namespace有相同的类名的情况的时候，**必须**全部使用别名来处理。

## 关于常量
- 附属于类的常量必须使用const定义，例如ActiveRecord中定义数据库里status/flag类型字段的具体数值和含义的时候。
- 归属于业务逻辑的常量，**强烈建议**定义在config目录中，通过config方法调用。
- 对于需要根据环境（env）进行变更的内容，按照以下原则进行：
    - 配置内容属于架构信息、服务器信息、有必要隐藏无法提交git的信息，请使用.env文件配合env()方法进行设定（.env.example中必须添加对应的字段和示例）
    - 属于业务逻辑的常量内容，或可以提交到git无需隐藏的部分配置类信息，直接在定义代码处使用环境判断函数判断环境后将所有值都写入代码中。

## blade 模版引擎  
- 使用如下标志符
```
{{  }}
```  
laravel5.0起，是会其进行html_filter处理的，可以避免XSS攻击



------------

资料参考
- [https://www.zybuluo.com/phper/note/65033]
- [https://wenku.baidu.com/view/1693ade0964bcf84b8d57bd3.html]
- [http://www.ultrakuma.com/laravel-framework-specification-5-1-11.html]
