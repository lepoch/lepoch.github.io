---
title: æ¨¡å¼-æ¡¥æ¥æ¨¡å¼
date: 2018-06-15T16:35:00.000Z
tags:
  - æ¨¡å¼
  - ç¬”è®°
categories:
  - æ¨¡å¼
  - ç»“æ„å‹æ¨¡å¼
---

è®¾è®¡æ¨¡å¼ä¹‹æ¡¥æ¥æ¨¡å¼
<!-- MORE -->

## ç®€ä»‹
> å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿ä»–ä»¬éƒ½å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–ã€‚

ä¹Ÿå°±æ˜¯å¦‚æœå®ç°ç³»ç»Ÿï¼Œå¯ä»¥å¤šç»´åº¦åˆ†ç±»ï¼Œé‚£å°±èƒ½è®©ä»–ä»¬ç‹¬ç«‹å˜åŒ–ï¼Œä»¥å‡å°‘è€¦åˆã€‚

**å¤šç»„åˆ**ï¼Œ**å°‘ç»§æ‰¿** çš„ä½“ç°ã€‚

## å…³é”®ç‚¹
- å¯å¤šç»´åº¦åˆ†ç±»
- å¤šç»´åº¦åˆ†ç±»å¯ä»¥å˜åŒ–
- å¯ç”¨èšåˆè¡¨ç¤º

## ç±»å›¾
![](http://www.plantuml.com/plantuml/svg/TP1DJeOm48RtSue9Autf5GpWohqNg31ga_wGTbWXLz0pi23n45v7pl5f2gRmbUKCpyFxTih0qdDlD3mfreJ5CitBnxnyJJ_VdmL0esK8-A0LMTuFyZcmbmrZt5Rhg9p50H3lXWqOqNNavT-NcriOrxzuUb6MsYjjpnvJ7asdoP1bvyzJVg4ehtsTRRnaIjmgoaVZNAXF18Z7GE7LwniBSP_U0I3pID5tGhmVk6p5ZKoMER3EWf0C_-tSBhKas_P6Nm00)

## å®ç°
### PHP

#### å®šä¹‰
##### æŠ½è±¡è€…
```PHP
abstract class Abstraction {
    /**
     * @var Implementor
     */
    protected $implementor;

    public function setImplementor(Implementor $imp) {
        $this->implementor = $imp;
    }
    abstract public function operation();
}

class RefinedAbstraction extends Abstraction {

    public function operation()
    {
        $this->implementor->operationImp();
    }
}
```

##### å®ç°è€…
```PHP
abstract class Implementor {
    abstract public function operationImp();
}
class ConcreteImplementorA extends Implementor {

    public function operationImp()
    {
        echo 'å…·ä½“å®ç°è€…A', PHP_EOL;
    }
}
class ConcreteImplementorB extends Implementor {

    public function operationImp()
    {
        echo 'å…·ä½“å®ç°è€…B', PHP_EOL;
    }
}
```

#### ä½¿ç”¨
```PHP
$ab = new RefinedAbstraction();
$ab->setImplementor(new ConcreteImplementorA());
$ab->operation();

$ab->setImplementor(new ConcreteImplementorB());
$ab->operation();
```

#### ç»“æœ
```
å…·ä½“å®ç°è€…A
å…·ä½“å®ç°è€…B

```

## å…·ä½“ä¾‹å­ ğŸŒ°
### é¢˜
ç”»å›¾ï¼Œå­˜åœ¨ä¸‰ç§å›¾å½¢ï¼Œä¸‰ç§é¢œè‰²
- æ­£æ–¹å½¢ã€é•¿æ–¹å½¢ã€åœ†å½¢
- çº¢ã€ç»¿ã€è“

### ä½¿ç”¨ç»§æ‰¿çš„æ–¹å¼
#### å½¢çŠ¶
![](http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuGh9BCb9LL1widlfqxsBddTjUx9ZrxC5Ev_FQdc-U_cpplrAN5pFrYv-DcqdK5P1jxH0Lm6YZElbrFrOH9_EQKCNudg-Qv4nH0GYo_LyztvKWHUJvw88WFKOGKGWza2reOX1TQA8mJGRGWI1JaTeHeWXD6E8EQJcfG231G00)

#### é¢œè‰²
![](http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuGh9BCb9LL1widlfoqLpNdHkUh9ZrxC5Ev_FQdc-U_cpplrAN5pFTorIq2qjq5M0AE1wldi_2l_5vBaeVAvdQnS_cxRpwTv5nX1ne0AkbrFtOuWzdTE6Ae3GQGGH15g5q8aGW-f4223fD8G80XsDq8aG0-b45N18pKi1XWC0)

#### é—®é¢˜
å¾ˆæ˜æ˜¾ï¼Œå¦‚æœå†æ·»åŠ å½¢çŠ¶æˆ–è€…é¢œè‰²ï¼Œé‚£ä¼šç–¯æ‰ã€‚

### ä»¥ç»„åˆæˆ–è€…èšåˆçš„æ–¹å¼
![](http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuGh9BCb9LL1widlfyzqjJoTqFEkOzgAXzKNZB23x-QoMPzDsFjtJhyJ5zNpN8WNTqW9TXPUBvhpetCJrVFT-5FwBoNDH-5pFrYu6QTuBrGPaFE_QnlLowduiea_djA49GIrCoI_FqrLuldloitbpG5QYYe0iHHL1s8eg3h4NKnnaCwQWGsfU2Z1i0000)

ä½¿ç”¨æ—¶ï¼ŒæŠŠé¢œè‰²å’Œå›¾å½¢è¿›è¡Œç»„åˆã€‚
okï¼Œä¸‹é¢å’±ä»¬æ¥ç”¨æ¡¥æ¥æ¨¡å¼å®ç°è¿™å¥—æ–¹æ¡ˆ

### ç±»å›¾
![](http://www.plantuml.com/plantuml/svg/2yaioKbLK7goU-dptIrF9tGywvZseg7rHUCi8Flvh9PdqtO-tTCFP3njtVvax-Jd6tS_dRrFYOihCQcuf2WnkKGXEIUnk5WXE2En85MXcaj1GLaXEJydlqZ1Ii4PH0D5j1MAKql070qm2L6W2LHHbf-P0bPG3JEkLY6bAB5S0ovPomKrlx0qiGXYWJOE9K6foIM9UUav-5KvPnOburA2uIk8SwlHdLYGc9bNWiq1AH2rk1Iu5wMcvk5NufHJcefB1HSq47HB2tHrQ-mWOSu5ypQwECYZ6890rIam8MZyW1s59WPo1PeG5oGiT8ioqpDAT7NpeGOwfEQbbERc0000)

### PHP
#### å®šä¹‰
##### æŠ½è±¡è€…
```PHP
abstract class Shape {
    /**
     * @var Color
     */
    protected $color;
    public function setColor(Color $color) {
        $this->color = $color;
    }
    abstract public function draw() : void;
}
class Square extends Shape {

    public function draw()
    : void
    {
        echo 'æ­£æ–¹å½¢ï¼Œ';
        $this->color->paint();
        echo PHP_EOL;
    }
}
class Rectangle extends Shape {

    public function draw()
    : void
    {
        echo 'é•¿æ–¹å½¢ï¼Œ';
        $this->color->paint();
        echo PHP_EOL;
    }
}
class Circle extends Shape {

    public function draw()
    : void
    {
        echo 'åœ†å½¢ï¼Œ';
        $this->color->paint();
        echo PHP_EOL;
    }
}
```
##### å®ç°è€…
```PHP
abstract class Color {
    abstract public function paint() : void;
}
class Red extends Color {

    public function paint()
    : void
    {
        echo 'çº¢è‰²';
    }
}
class Green extends Color {

    public function paint()
    : void
    {
        echo 'ç»¿è‰²';
    }
}
class Blue extends Color {

    public function paint()
    : void
    {
        echo 'è“è‰²';
    }
}
```
#### ä½¿ç”¨
```PHP
$shape = new Circle();
$shape->setColor(new Red());
$shape->draw();

$shape = new Square();
$shape->setColor(new Green());
$shape->draw();

$shape = new Rectangle();
$shape->setColor(new Blue());
$shape->draw();
```
#### ç»“æœ
```
åœ†å½¢ï¼Œçº¢è‰²
æ­£æ–¹å½¢ï¼Œç»¿è‰²
é•¿æ–¹å½¢ï¼Œè“è‰²

```

## ç”Ÿæˆå›¾çš„ä»£ç 
### æ¡¥æ¥æ¨¡å¼
```plantuml
@startuml
Title "æ¡¥æ¥æ¨¡å¼"

class Client
abstract class Abstraction {
  +{abstract} operation()
}
class refinedAbstraction {
  +operation()
}

abstract class Implementor {
  +{abstract} operationImp()
}

class ConcrateImplementorA {
  +operationImp()
}
class ConcrateImplementorB {
  +operationImp()
}

Client -right--> Abstraction

refinedAbstraction -up--|> Abstraction

ConcrateImplementorA -up--|> Implementor
ConcrateImplementorB -up--|> Implementor

Implementor -left<--o Abstraction
Abstraction -righto--> Implemento


@enduml
```

### ä»¥å½¢çŠ¶ä¸ºæ ¹çš„ç»§æ‰¿
```plantuml
@startuml
Title "ä»¥å½¢çŠ¶ä¸ºæ ¹çš„ç»§æ‰¿"

æ­£æ–¹å½¢ -up- å½¢çŠ¶
é•¿æ–¹å½¢ -up- å½¢çŠ¶
åœ†å½¢ -up- å½¢çŠ¶

çº¢3 -up- åœ†å½¢
ç»¿3 -up- åœ†å½¢
è“3 -up- åœ†å½¢

çº¢2 -up- é•¿æ–¹å½¢
ç»¿2 -up- é•¿æ–¹å½¢
è“2 -up- é•¿æ–¹å½¢

çº¢1 -up- æ­£æ–¹å½¢
ç»¿1 -up- æ­£æ–¹å½¢
è“1 -up- æ­£æ–¹å½¢
@enduml
```

### ä»¥é¢œè‰²ä¸ºæ ¹çš„ç»§æ‰¿
```plantuml
@startuml
Title "ä»¥é¢œè‰²ä¸ºæ ¹çš„ç»§æ‰¿"

çº¢ -up- é¢œè‰²
ç»¿ -up- é¢œè‰²
è“ -up- é¢œè‰²

æ­£æ–¹å½¢3 -up- è“
é•¿æ–¹å½¢3 -up- è“
åœ†å½¢3 -up- è“

æ­£æ–¹å½¢2 -up- ç»¿
é•¿æ–¹å½¢2 -up- ç»¿
åœ†å½¢2 -up- ç»¿

æ­£æ–¹å½¢1 -up- çº¢
é•¿æ–¹å½¢1 -up- çº¢
åœ†å½¢1 -up- çº¢
@enduml
```

### ä»¥ç»„åˆæˆ–è€…èšåˆçš„æ–¹å¼
```plantuml
@startuml
Title "ä»¥ç»„åˆæˆ–è€…èšåˆçš„æ–¹å¼"

çº¢ -up- é¢œè‰²
ç»¿ -up- é¢œè‰²
è“ -up- é¢œè‰²

æ­£æ–¹å½¢ -up- å½¢çŠ¶
é•¿æ–¹å½¢ -up- å½¢çŠ¶
åœ†å½¢ -up- å½¢çŠ¶

çº¢ -down- ç»“æœ
ç»¿ -down- ç»“æœ
è“ -down- ç»“æœ
æ­£æ–¹å½¢ -down- ç»“æœ
é•¿æ–¹å½¢ -down- ç»“æœ
åœ†å½¢ -down- ç»“æœ
@enduml
```

### ä»¥ç»„åˆæˆ–è€…èšåˆçš„æ–¹å¼çš„å…·ä½“ç±»å›¾
```plantuml
Title "ä»¥ç»„åˆæˆ–è€…èšåˆçš„æ–¹å¼çš„å…·ä½“ç±»å›¾"

abstract class Shape {
  # color : Color
  + setColor(Color color) : void
  + {abstract} draw() : void
}
class Square {
  + draw() : void
}
class Rectangle {
  + draw() : void
}
class Circle {
  + draw() : void
}

abstract class Color {
  + {abstract} paint() : void
}
class Red {
  + paint() : void
}
class Green {
  + paint() : void
}
class Blue {
  + paint() : void
}

Square -up--|> Shape
Rectangle -up--|> Shape
Circle -up--|> Shape

Red -up--|> Color
Green -up--|> Color
Blue -up--|> Color

Color -right--o Shape
@enduml
```

## å‚è€ƒ
[è®¾è®¡æ¨¡å¼è¯»ä¹¦ç¬”è®°â€”â€“æ¡¥æ¥æ¨¡å¼](http://cmsblogs.com/?p=357)
