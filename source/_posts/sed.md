---
title: sed
date: 2017-03-23 00:00:00
tags:
 - Linux
 - cmd

categories:
 - Linux


---

sed 使用笔记

<!-- MORE -->
# 简介
一个文本处理工具。

# 常用选项
>  -n∶使用安静(silent)模式。在一般 sed 的用法中，所有来自 STDIN的资料一般都会被列出到萤幕上。但如果加上 -n 参数后，则只有经过sed 特殊处理的那一行(或者动作)才会被列出来。  
 -e∶直接在指令列模式上进行 sed 的动作编辑；  
 -f∶直接将 sed 的动作写在一个档案内， -f filename 则可以执行 filename 内的sed 动作；  
 -r∶sed 的动作支援的是延伸型正规表示法的语法。(预设是基础正规表示法语法)  
 -i∶直接修改读取的档案内容。  

# 常用命令
> a 在当前行下面插入文本。    
 i 在当前行上面插入文本。  
 c 把选定的行改为新的文本。  
 d 删除，删除选择的行。  
 D 删除模板块的第一行。  
 s 替换指定字符  
 h 拷贝模板块的内容到内存中的缓冲区。  
 H 追加模板块的内容到内存中的缓冲区。  
 g 获得内存缓冲区的内容，并替代当前模板块中的文本。  
 G 获得内存缓冲区的内容，并追加到当前模板块文本的后面。  
 l 列表不能打印字符的清单。  
 n 读取下一个输入行，用下一个命令处理新的行而不是用第一个命令。  
 N 追加下一个输入行到模板块后面并在二者间嵌入一个新行，改变当前行号码。  
 p 打印模板块的行。  
 P(大写) 打印模板块的第一行。  
 q 退出Sed。  
 b lable 分支到脚本中带有标记的地方，如果分支不存在则分支到脚本的末尾。  
 r file 从file中读行。  
 t label if分支，从最后一行开始，条件一旦满足或者T，t命令，将导致分支到带有标号的命令处，或者到脚本的末尾。  
 T label 错误分支，从最后一行开始，一旦发生错误或者T，t命令，将导致分支到带有标号的命令处，或者到脚本的末尾。  
 w file 写并追加模板块到file末尾。  
 W file 写并追加模板块的第一行到file末尾。  
 ! 表示后面的命令对所有没有被选定的行发生作用。  
 = 打印当前行号码。  
 \# 把注释扩展到下一个换行符以前。  


# 栗子
## 首行尾添加字符，直接修改文件
使用 -i 选项， s命令  
`sed -i '1s/$/&123' file`

## 去除指定字符串""#zlib zlibmodule.c" 的首个字符  
使用s命令，sed '/匹配字符串/s/替换源字符串/替换目标字符串/g'  
`sed '/#zlib zlibmodule.c/s/.//' file`

## 去除指定字符串 "#_ssl _ssl.c" 所在行与之后的2行的特定字符 "#" 
使用 /匹配字符串/,+2， 表示取得匹配字符串和之后的两行  
{代码块}  
`sed '/#_ssl _ssl.c/,+2{s/#//}' file`
